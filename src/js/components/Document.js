import React, { Component } from "react";
import update from 'immutability-helper';
import * as d3 from 'd3';
import Lines from './Lines'
import './../../css/main.css'
import Guides from "./Guides";
import { updateGuide, computeLine, distance_guides, create_line } from "./HelperLine";
// import avatar from '../../../../static/img/avatar.png';

var guide_global;
var distance;
var list = [
    // Lorem
    [[173.25, 76.5],[173.25, 78],[174, 80.25],[174.75, 82.5],[180.75, 87],[186, 88.5],[192.75, 88.5],[199.5, 85.5],[209.25, 78.75],[213.75, 72.75],[216, 66],[217.5, 58.5],[215.25, 51],[212.25, 48],[209.25, 47.25],[204.75, 51],[200.25, 57.75],[196.5, 66.75],[191.25, 85.5],[187.5, 99],[183.75, 111],[178.5, 120.75],[174.75, 123.75],[173.25, 122.25],[172.5, 118.5],[174, 114],[176.25, 109.5],[180.75, 106.5],[183.75, 107.25],[186.75, 110.25],[189, 114.75],[194.25, 121.5],[199.5, 123.75],[204.75, 122.25],[207.75, 120.75],[215.25, 114]]
    , [[228, 106.5],[229.5, 106.5],[233.25, 106.5],[236.25, 107.25],[239.25, 111.75],[239.25, 117.75],[237.75, 121.5],[234, 122.25],[228.75, 120],[222, 113.25],[220.5, 108.75],[222.75, 106.5],[227.25, 105.75],[229.5, 105.75]]
    , [[255, 124.5],[255.75, 124.5],[256.5, 123.75],[256.5, 123],[256.5, 118.5],[255.75, 114],[255.75, 111],[255.75, 108.75],[256.5, 106.5],[258, 104.25],[260.25, 102.75],[261.75, 102.75],[264.75, 103.5],[267.75, 106.5],[270.75, 111.75],[272.25, 117.75],[273.75, 126],[273.75, 128.25],[275.25, 128.25],[275.25, 127.5],[276, 126]]
    , [[287.25, 110.25],[287.25, 111],[287.25, 111.75],[288, 112.5],[289.5, 113.25],[291.75, 111],[294, 108.75],[295.5, 105.75],[297, 99.75],[296.25, 96.75],[294.75, 94.5],[292.5, 94.5],[290.25, 96.75],[288.75, 101.25],[288.75, 109.5],[290.25, 115.5],[292.5, 120],[296.25, 123],[300.75, 123.75],[303.75, 122.25],[306, 118.5],[307.5, 114],[309, 110.25],[311.25, 105.75],[313.5, 103.5],[316.5, 104.25],[319.5, 107.25],[322.5, 116.25],[323.25, 120.75],[324, 124.5],[324, 126],[324, 124.5],[324, 120],[325.5, 115.5],[327, 111.75],[330, 108],[334.5, 106.5],[336.75, 107.25],[339, 111],[339.75, 114.75],[340.5, 119.25],[340.5, 122.25],[340.5, 123],[341.25, 122.25],[342, 120],[343.5, 114],[345, 110.25],[347.25, 107.25],[350.25, 105],[353.25, 104.25],[357.75, 106.5],[360, 113.25],[361.5, 120],[362.25, 125.25]]
    // ipsum
    , [[454.5, 113.25],[453.75, 113.25],[454.5, 115.5],[455.25, 120.75],[456.75, 129],[456.75, 130.5],[456.75, 132]]
    , [[449.25, 84.75],[450, 85.5],[451.5, 87.75],[453, 90],[453.75, 91.5]]
    , [[477, 111],[477, 113.25],[478.5, 124.5],[480, 135.75],[481.5, 148.5],[482.25, 160.5],[482.25, 174],[481.5, 175.5],[480, 173.25],[477.75, 166.5],[475.5, 150.75],[474.75, 139.5],[475.5, 129.75],[477.75, 120.75],[481.5, 114],[487.5, 106.5],[492, 105],[497.25, 107.25],[501, 113.25],[502.5, 123.75],[501, 128.25],[496.5, 131.25],[491.25, 131.25],[486, 129],[483.75, 127.5]]
    , [[517.5, 132.75],[517.5, 131.25],[517.5, 130.5],[517.5, 126],[517.5, 115.5],[517.5, 109.5],[516.75, 104.25],[516.75, 101.25],[517.5, 99],[518.25, 99.75],[520.5, 101.25],[523.5, 103.5],[529.5, 110.25],[534, 116.25],[537, 122.25],[538.5, 127.5],[538.5, 129.75],[535.5, 130.5],[533.25, 129.75],[532.5, 128.25],[532.5, 127.5],[534.75, 127.5],[537.75, 127.5],[541.5, 126.75],[544.5, 126],[548.25, 123.75],[552.75, 118.5],[555, 114.75],[556.5, 110.25],[557.25, 106.5],[557.25, 104.25],[556.5, 103.5],[556.5, 105],[556.5, 109.5],[556.5, 114.75],[558.75, 122.25],[560.25, 125.25],[562.5, 126.75],[565.5, 126.75],[567.75, 123.75],[571.5, 114.75],[573, 110.25],[573.75, 106.5],[574.5, 103.5],[575.25, 104.25],[575.25, 107.25],[576, 112.5],[577.5, 117.75],[579, 122.25],[582, 125.25],[584.25, 125.25],[586.5, 123],[588.75, 118.5],[591.75, 112.5],[594, 108.75],[597, 106.5],[600, 105.75],[603, 107.25],[608.25, 114.75],[609.75, 120],[611.25, 124.5],[612, 126.75],[612, 128.25],[612, 126.75],[612.75, 123.75],[614.25, 118.5],[616.5, 114.75],[620.25, 110.25],[623.25, 108.75],[625.5, 109.5],[627.75, 113.25],[630, 117.75],[630.75, 125.25],[630.75, 128.25],[630.75, 129.75],[631.5, 129.75],[632.25, 126.75],[633, 122.25],[634.5, 117],[637.5, 112.5],[641.25, 108],[645, 107.25],[648, 108],[651, 111.75],[653.25, 117.75],[656.25, 126],[657.75, 129.75],[658.5, 131.25]]
    // dolor
    , [[810.75, 108],[810.75, 106.5],[810.75, 105.75],[810.75, 105],[810.75, 103.5],[808.5, 103.5],[804.75, 105.75],[801.75, 109.5],[798.75, 114.75],[798, 119.25],[798.75, 123],[800.25, 124.5],[803.25, 126],[807, 126],[810.75, 123],[814.5, 116.25],[819, 104.25],[820.5, 95.25],[821.25, 86.25],[821.25, 81],[821.25, 76.5],[821.25, 72.75],[821.25, 73.5],[820.5, 76.5],[820.5, 84.75],[820.5, 100.5],[820.5, 109.5],[822, 116.25],[823.5, 120.75],[825, 120.75],[826.5, 120]]
    , [[846.75, 105.75],[846.75, 106.5],[846.75, 105.75],[847.5, 105.75],[849, 104.25],[851.25, 103.5],[855.75, 104.25],[858.75, 107.25],[858.75, 113.25],[857.25, 119.25],[853.5, 123.75],[851.25, 124.5],[846, 123],[840, 117],[837.75, 109.5],[838.5, 104.25],[845.25, 99],[848.25, 98.25],[851.25, 97.5]]
    , [[876, 84.75],[878.25, 85.5],[880.5, 86.25],[884.25, 85.5],[893.25, 78.75],[897.75, 71.25],[900, 62.25],[899.25, 54.75],[894, 43.5],[888.75, 38.25],[885.75, 36],[882.75, 39],[881.25, 48],[881.25, 66],[881.25, 90],[882.75, 109.5],[884.25, 123.75],[885.75, 128.25]]
    , [[911.25, 108],[912, 108.75],[912.75, 108],[913.5, 107.25],[915, 106.5],[917.25, 105.75],[919.5, 107.25],[921.75, 114.75],[920.25, 121.5],[917.25, 127.5],[913.5, 129.75],[906, 126.75],[903, 120.75],[903, 115.5],[904.5, 110.25],[908.25, 106.5],[912, 102]]
    , [[928.5, 116.25],[929.25, 117],[930, 117],[931.5, 116.25],[933, 112.5],[933.75, 108],[933.75, 105],[933.75, 102.75],[933.75, 101.25],[934.5, 99.75],[937.5, 98.25],[940.5, 97.5],[942.75, 99],[945.75, 103.5],[948, 111],[950.25, 121.5],[951.75, 123.75],[953.25, 125.25]]
    // sit
    , [[1056, 129],[1056.75, 129],[1057.5, 128.25],[1059.75, 123],[1060.5, 117],[1060.5, 110.25],[1059, 102.75],[1057.5, 99.75],[1057.5, 98.25],[1057.5, 99],[1059, 100.5],[1064.25, 106.5],[1068, 111.75],[1071, 117.75],[1073.25, 123],[1073.25, 127.5],[1071, 131.25],[1068, 131.25],[1065, 129.75],[1063.5, 126.75],[1062.75, 124.5]]
    , [[1097.25, 109.5],[1097.25, 114],[1098, 120],[1098.75, 127.5],[1099.5, 127.5],[1098.75, 124.5]]
    , [[1094.25, 67.5],[1095.75, 68.25],[1096.5, 71.25],[1097.25, 74.25],[1098, 77.25]]
    , [[1113, 34.5],[1113, 35.25],[1113, 36.75],[1114.5, 50.25],[1116, 69.75],[1117.5, 92.25],[1118.25, 110.25],[1119, 117],[1119, 122.25]]
    , [[1134.75, 77.25],[1134, 78],[1130.25, 81.75],[1117.5, 86.25],[1110, 86.25]]
    // amet
    , [[1219.5, 111.75],[1219.5, 111],[1220.25, 109.5],[1221.75, 107.25],[1224, 105.75],[1225.5, 107.25],[1225.5, 112.5],[1221.75, 123],[1218.75, 127.5],[1215, 129.75],[1212, 129],[1210.5, 126],[1212, 117.75],[1214.25, 111.75],[1218, 107.25],[1220.25, 105],[1222.5, 105.75],[1224, 111.75],[1224.75, 117.75],[1225.5, 123],[1227, 128.25],[1229.25, 130.5],[1233.75, 131.25],[1236, 128.25],[1238.25, 122.25],[1241.25, 113.25],[1243.5, 108],[1245, 104.25],[1248, 101.25],[1251, 100.5],[1255.5, 104.25],[1257, 110.25],[1258.5, 117.75],[1259.25, 125.25],[1259.25, 129],[1259.25, 131.25],[1260, 129],[1260, 125.25],[1261.5, 119.25],[1264.5, 112.5],[1267.5, 109.5],[1269.75, 108.75],[1272.75, 110.25],[1275, 115.5],[1276.5, 123.75],[1276.5, 128.25],[1276.5, 131.25],[1275.75, 131.25],[1275.75, 127.5],[1276.5, 121.5],[1278, 116.25],[1281, 111],[1283.25, 107.25],[1287.75, 105.75],[1290, 108.75],[1292.25, 114.75],[1293, 122.25],[1293.75, 128.25],[1293.75, 127.5],[1294.5, 125.25]]
    , [[1304.25, 106.5],[1305, 106.5],[1305.75, 107.25],[1307.25, 107.25],[1309.5, 106.5],[1312.5, 105],[1314.75, 103.5],[1315.5, 102],[1315.5, 99.75],[1314, 98.25],[1312.5, 97.5],[1310.25, 98.25],[1307.25, 100.5],[1304.25, 104.25],[1302.75, 110.25],[1302.75, 118.5],[1305.75, 122.25],[1310.25, 124.5],[1316.25, 123.75],[1322.25, 120],[1325.25, 117],[1328.25, 114]]
    , [[1341.75, 38.25],[1340.25, 39],[1339.5, 40.5],[1338, 50.25],[1337.25, 71.25],[1337.25, 90],[1337.25, 105],[1337.25, 114.75],[1338.75, 117.75]]
    , [[1359, 78],[1358.25, 78],[1357.5, 78],[1350.75, 80.25],[1343.25, 81.75],[1335.75, 82.5],[1332, 82.5]]
    // consectetur
    , [[147, 222],[146.25, 222.75],[145.5, 222.75],[144.75, 223.5],[144, 224.25],[143.25, 225],[141.75, 226.5],[140.25, 228],[138.75, 230.25],[137.25, 234],[136.5, 237],[135.75, 240.75],[135, 244.5],[135.75, 249],[136.5, 252],[137.25, 255.75],[138.75, 258.75],[141, 261],[143.25, 263.25],[144.75, 264.75],[147.75, 265.5],[150, 266.25],[152.25, 266.25],[155.25, 264.75],[157.5, 264],[159.75, 261.75],[161.25, 260.25],[162.75, 258],[164.25, 255.75],[165.75, 252.75],[166.5, 250.5],[167.25, 248.25],[168, 246],[168.75, 243.75],[169.5, 241.5],[170.25, 240],[171.75, 238.5],[172.5, 237],[174, 236.25],[175.5, 235.5],[177, 234.75],[177.75, 234],[179.25, 234.75],[180.75, 234.75],[182.25, 236.25],[183.75, 237.75],[185.25, 240.75],[186, 243.75],[186, 247.5],[186, 250.5],[186, 254.25],[185.25, 257.25],[184.5, 260.25],[183.75, 262.5],[182.25, 264],[180.75, 264.75],[178.5, 264.75],[176.25, 264.75],[174, 263.25],[172.5, 261],[170.25, 258.75],[168.75, 255.75],[167.25, 252],[167.25, 249],[167.25, 246],[167.25, 243],[168.75, 240],[170.25, 237.75],[171.75, 236.25],[174, 234.75],[175.5, 234],[177.75, 234],[179.25, 234],[180.75, 234.75],[181.5, 236.25],[182.25, 238.5],[183, 241.5],[183.75, 244.5],[183.75, 247.5],[184.5, 249.75],[184.5, 252],[184.5, 253.5],[184.5, 254.25],[184.5, 255],[184.5, 255.75],[184.5, 255],[184.5, 253.5],[184.5, 252],[185.25, 250.5],[186, 248.25],[186, 246.75],[187.5, 244.5],[188.25, 243],[189.75, 241.5],[190.5, 240],[192, 239.25],[193.5, 239.25],[195, 239.25],[196.5, 239.25],[198, 240.75],[199.5, 242.25],[200.25, 245.25],[201, 248.25],[201.75, 251.25],[202.5, 255],[203.25, 258],[203.25, 260.25],[203.25, 262.5],[203.25, 264],[203.25, 265.5],[203.25, 264.75],[203.25, 264],[203.25, 261.75],[203.25, 260.25],[204, 257.25],[204.75, 254.25],[205.5, 251.25],[206.25, 248.25],[207.75, 246],[208.5, 243.75],[210, 241.5],[210.75, 240],[211.5, 238.5],[213, 238.5],[213.75, 240],[214.5, 241.5],[214.5, 243.75],[215.25, 246],[215.25, 248.25],[215.25, 251.25],[216, 253.5],[216.75, 256.5],[217.5, 258],[218.25, 259.5],[219, 261],[220.5, 261.75],[222, 261.75],[223.5, 261.75],[225, 261],[227.25, 259.5],[229.5, 257.25],[231, 253.5],[232.5, 249.75],[234, 246.75],[234.75, 243],[234.75, 240],[234.75, 237],[234.75, 234.75],[234.75, 233.25],[234.75, 231.75],[234.75, 230.25],[234.75, 229.5],[234.75, 228.75],[235.5, 229.5],[236.25, 229.5],[237, 231],[238.5, 232.5],[240.75, 234],[242.25, 236.25],[244.5, 239.25],[246.75, 242.25],[249, 245.25],[249.75, 248.25],[250.5, 250.5],[251.25, 252],[250.5, 253.5],[249.75, 255],[249, 255.75],[247.5, 255.75],[246, 255.75],[244.5, 255],[243, 255],[242.25, 254.25],[241.5, 254.25],[241.5, 253.5],[241.5, 252.75],[242.25, 252.75],[243.75, 252],[245.25, 252],[247.5, 252],[249.75, 251.25],[252, 251.25],[255, 250.5],[257.25, 249.75],[260.25, 249],[262.5, 247.5],[264, 246],[266.25, 244.5],[267.75, 243],[269.25, 240.75],[270.75, 239.25],[271.5, 237],[271.5, 235.5],[272.25, 234],[272.25, 232.5],[271.5, 231],[270.75, 230.25],[268.5, 229.5],[267, 229.5],[264, 230.25],[261.75, 231.75],[259.5, 233.25],[257.25, 235.5],[254.25, 241.5],[254.25, 244.5],[254.25, 247.5],[255, 249.75],[256.5, 252],[259.5, 253.5],[261.75, 255],[264.75, 255],[268.5, 255],[271.5, 254.25],[275.25, 252.75],[278.25, 250.5],[280.5, 247.5],[282, 245.25],[283.5, 243]]
    , [[300, 231],[300.75, 231],[301.5, 230.25],[302.25, 229.5],[302.25, 228.75],[302.25, 228],[301.5, 228.75],[300.75, 229.5],[299.25, 231],[297.75, 232.5],[295.5, 234.75],[293.25, 237.75],[291, 240.75],[289.5, 244.5],[288, 248.25],[287.25, 251.25],[286.5, 254.25],[287.25, 257.25],[288.75, 259.5],[291.75, 261],[294.75, 262.5],[297.75, 262.5],[301.5, 261],[306, 259.5],[309.75, 255.75],[314.25, 252]]
    , [[328.5, 171],[328.5, 171.75],[328.5, 172.5],[328.5, 174.75],[329.25, 179.25],[330, 183.75],[330, 186.75],[330.75, 193.5],[332.25, 203.25],[333.75, 213],[334.5, 222.75],[335.25, 232.5],[336, 240],[337.5, 247.5],[338.25, 252],[339, 255.75],[339.75, 257.25]]
    , [[357, 222],[356.25, 222],[355.5, 222],[354.75, 222],[353.25, 222.75],[350.25, 223.5],[347.25, 223.5],[339, 225.75],[334.5, 227.25],[330, 228],[326.25, 229.5],[322.5, 230.25]]
    , [[348.75, 248.25],[348.75, 249],[349.5, 249],[350.25, 249],[351.75, 248.25],[353.25, 247.5],[355.5, 246],[357, 244.5],[358.5, 243],[360.75, 241.5],[361.5, 240],[362.25, 237.75],[363, 236.25],[363.75, 234.75],[363, 234],[362.25, 232.5],[360.75, 231.75],[358.5, 231.75],[356.25, 231.75],[353.25, 232.5],[351, 233.25],[348, 234.75],[345.75, 237],[343.5, 240],[342.75, 243],[342, 246],[342, 248.25],[342.75, 251.25],[343.5, 253.5],[346.5, 255],[349.5, 256.5],[353.25, 258],[357.75, 258.75],[361.5, 258.75],[366, 258],[370.5, 256.5],[374.25, 255],[377.25, 252]]
    , [[376.5, 167.25],[378, 167.25],[378.75, 168],[379.5, 168.75],[379.5, 169.5],[380.25, 171.75],[380.25, 174],[380.25, 178.5],[380.25, 182.25],[381, 189.75],[381.75, 199.5],[382.5, 208.5],[383.25, 218.25],[384.75, 226.5],[385.5, 234],[387, 240],[387.75, 244.5],[388.5, 248.25],[389.25, 249.75]]
    , [[414, 221.25],[414.75, 220.5],[414, 219.75],[413.25, 219],[411.75, 218.25],[409.5, 218.25],[407.25, 217.5],[404.25, 217.5],[399.75, 218.25],[395.25, 219],[390.75, 219.75],[386.25, 220.5],[382.5, 221.25],[378.75, 222],[375.75, 222],[373.5, 222.75]]
    , [[402, 252.75],[402.75, 253.5],[402.75, 254.25],[403.5, 255],[404.25, 255],[405, 255],[405.75, 255],[406.5, 255],[408, 254.25],[409.5, 253.5],[411, 252],[412.5, 249.75],[414, 247.5],[416.25, 244.5],[417, 241.5],[417.75, 239.25],[418.5, 237],[419.25, 235.5],[419.25, 234],[419.25, 233.25],[419.25, 232.5],[418.5, 233.25],[417.75, 234],[417.75, 235.5],[417, 237],[416.25, 240],[415.5, 243],[414.75, 245.25],[415.5, 247.5],[416.25, 249.75],[417, 252],[417.75, 253.5],[419.25, 254.25],[420.75, 255],[423, 255.75],[425.25, 255],[426.75, 253.5],[428.25, 252],[430.5, 249],[432, 246.75],[432.75, 243.75],[434.25, 240.75],[435, 238.5],[435.75, 236.25],[435.75, 234],[436.5, 232.5],[436.5, 231],[436.5, 230.25],[437.25, 230.25],[437.25, 231],[437.25, 232.5],[437.25, 234.75],[437.25, 237],[437.25, 239.25],[437.25, 242.25],[437.25, 245.25],[438, 247.5],[438.75, 249.75],[439.5, 252],[440.25, 253.5],[441, 255],[442.5, 255.75],[444, 256.5],[446.25, 256.5],[447.75, 255.75],[450, 254.25],[451.5, 252],[453, 249.75],[453.75, 247.5],[454.5, 245.25],[455.25, 243],[456, 240.75],[456.75, 238.5],[456.75, 237],[457.5, 235.5],[458.25, 234],[458.25, 232.5],[459, 231.75],[459.75, 231],[461.25, 229.5],[462, 228.75],[463.5, 228],[464.25, 228],[465.75, 227.25],[466.5, 227.25],[468, 227.25],[468.75, 228],[469.5, 229.5],[469.5, 231],[470.25, 234],[470.25, 237],[471, 240],[471, 243.75],[471.75, 247.5],[472.5, 250.5],[474, 253.5],[474.75, 255.75]]
    
    // adipiscing
    , [[698.25, 226.5],[697.5, 224.25],[697.5, 223.5],[698.25, 222.75],[698.25, 222],[699, 221.25],[699.75, 220.5],[700.5, 219.75],[702, 219],[702.75, 219],[704.25, 218.25],[705.75, 219],[707.25, 219.75],[708, 220.5],[709.5, 222.75],[710.25, 225],[711, 228],[711, 231.75],[710.25, 235.5],[709.5, 239.25],[708, 242.25],[706.5, 245.25],[705, 247.5],[702.75, 249],[701.25, 249.75],[699.75, 250.5],[698.25, 250.5],[696.75, 249.75],[695.25, 249],[694.5, 246.75],[693, 244.5],[692.25, 241.5],[692.25, 238.5],[692.25, 235.5],[692.25, 231.75],[693, 228.75],[694.5, 225.75],[695.25, 222.75],[696.75, 220.5],[698.25, 218.25],[699.75, 216.75],[700.5, 216],[702, 215.25],[702.75, 215.25],[704.25, 216],[706.5, 217.5],[707.25, 219],[708.75, 221.25],[709.5, 223.5],[711, 226.5],[711.75, 229.5],[712.5, 233.25],[713.25, 236.25],[714, 239.25],[714.75, 242.25],[715.5, 244.5],[716.25, 246.75],[717, 249],[717.75, 249.75],[718.5, 251.25],[719.25, 252],[720.75, 251.25],[721.5, 250.5],[722.25, 249],[723, 247.5]]
    , [[744, 218.25],[744, 217.5],[744.75, 217.5],[744.75, 216.75],[744.75, 216],[744.75, 215.25],[744, 214.5],[743.25, 214.5],[742.5, 215.25],[741, 216],[739.5, 217.5],[737.25, 219.75],[735.75, 222],[734.25, 225],[732, 228],[731.25, 231.75],[729.75, 234.75],[729, 237.75],[728.25, 240.75],[728.25, 243],[728.25, 244.5],[729, 246],[730.5, 246],[732, 246],[732.75, 245.25],[735, 243.75],[738, 240],[740.25, 237],[741.75, 234.75],[743.25, 231],[744.75, 228],[746.25, 222.75],[747, 216.75],[748.5, 211.5],[749.25, 207],[749.25, 204],[750, 201],[750, 198.75],[750, 195.75],[750, 194.25],[750, 192.75],[750, 192],[750, 192.75],[749.25, 193.5],[749.25, 195.75],[748.5, 198.75],[747.75, 203.25],[747.75, 207.75],[747, 211.5],[747, 215.25],[747, 219],[747, 224.25],[747.75, 229.5],[747.75, 233.25],[748.5, 237],[749.25, 240],[750, 242.25],[750, 243.75],[751.5, 244.5],[753, 244.5],[754.5, 243.75],[755.25, 243.75],[756.75, 242.25],[758.25, 240],[760.5, 238.5],[762, 236.25],[763.5, 234],[765, 232.5],[766.5, 231],[767.25, 229.5],[768.75, 228.75],[769.5, 228],[770.25, 228.75],[771, 229.5],[771.75, 231],[771.75, 232.5],[772.5, 234.75],[773.25, 237.75],[774, 240],[774.75, 242.25]]
    , [[766.5, 193.5],[767.25, 195],[768, 197.25],[768.75, 198],[768.75, 199.5],[768.75, 200.25],[768.75, 201]]
    , [[792, 225],[792, 225.75],[792.75, 226.5],[792.75, 227.25],[792.75, 228.75],[793.5, 232.5],[793.5, 237],[794.25, 242.25],[794.25, 247.5],[794.25, 252.75],[794.25, 258],[794.25, 263.25],[794.25, 267.75],[794.25, 271.5],[794.25, 274.5],[794.25, 276],[794.25, 277.5],[794.25, 278.25],[793.5, 278.25],[793.5, 276.75],[793.5, 274.5],[793.5, 271.5],[793.5, 268.5],[793.5, 264],[793.5, 259.5],[793.5, 255],[793.5, 251.25],[793.5, 249],[794.25, 245.25],[795, 242.25],[795.75, 239.25],[796.5, 237],[798, 234.75],[799.5, 232.5],[801, 231],[802.5, 229.5],[804, 228.75],[805.5, 228],[807, 228],[809.25, 229.5],[810.75, 231],[812.25, 231.75],[813, 234.75],[813.75, 237.75],[813.75, 241.5],[813, 244.5],[811.5, 246.75],[809.25, 249],[807, 249.75],[804, 250.5],[801.75, 249.75],[798.75, 248.25]]
    , [[829.5, 228],[829.5, 228.75],[829.5, 229.5],[829.5, 231],[829.5, 231.75],[829.5, 232.5],[829.5, 234],[829.5, 235.5],[829.5, 237.75],[829.5, 240],[829.5, 243],[829.5, 244.5]]
    , [[827.25, 205.5],[827.25, 206.25],[827.25, 207],[827.25, 207.75],[827.25, 208.5],[827.25, 210]]
    , [[853.5, 222],[853.5, 221.25],[852.75, 221.25],[852, 221.25],[851.25, 222],[850.5, 222.75],[849.75, 223.5],[849, 225],[848.25, 225.75],[848.25, 227.25],[848.25, 228],[848.25, 229.5],[849, 231],[849, 232.5],[849.75, 233.25],[850.5, 234.75],[851.25, 236.25],[852, 237],[852.75, 238.5],[853.5, 240.75],[854.25, 243],[854.25, 244.5],[853.5, 246],[852.75, 247.5],[851.25, 248.25],[849.75, 249],[848.25, 249],[846.75, 249],[844.5, 248.25],[843.75, 247.5],[843, 246.75],[842.25, 246]]
    , [[876.75, 220.5],[876.75, 221.25],[876.75, 222],[876, 222.75],[875.25, 224.25],[874.5, 225],[873.75, 226.5],[873, 228],[872.25, 230.25],[871.5, 232.5],[871.5, 234.75],[871.5, 238.5],[871.5, 241.5],[872.25, 244.5],[873.75, 246.75],[874.5, 248.25],[876, 249],[877.5, 249.75],[879.75, 249],[881.25, 247.5],[882.75, 246],[884.25, 245.25],[885.75, 243],[887.25, 240],[888.75, 237],[890.25, 234.75],[891, 233.25],[891.75, 232.5],[891.75, 231],[892.5, 230.25],[893.25, 230.25],[893.25, 231],[893.25, 231.75],[893.25, 234],[893.25, 235.5],[893.25, 237.75],[893.25, 240.75],[894, 243.75],[894, 245.25],[894.75, 246],[896.25, 246],[897, 245.25],[897, 244.5]]
    , [[895.5, 193.5],[895.5, 194.25],[895.5, 195],[895.5, 195.75],[895.5, 196.5],[895.5, 197.25],[895.5, 198],[895.5, 198.75],[895.5, 199.5],[895.5, 201]]
    , [[909, 244.5],[909, 242.25],[909.75, 241.5],[909.75, 240.75],[909.75, 239.25],[909.75, 238.5],[910.5, 237],[911.25, 236.25],[912, 234.75],[912, 234],[912.75, 232.5],[913.5, 231],[915, 231],[915, 230.25],[916.5, 230.25],[917.25, 231],[918.75, 231.75],[919.5, 233.25],[921, 234.75],[921.75, 237.75],[922.5, 240],[923.25, 242.25],[924, 244.5],[924, 245.25],[924, 246],[924, 246.75],[924, 246],[924, 245.25],[924, 244.5],[924.75, 243],[924.75, 241.5],[926.25, 240],[926.25, 238.5],[927.75, 236.25],[928.5, 234.75],[930, 234],[931.5, 232.5],[933, 231.75],[933.75, 231],[935.25, 230.25],[936, 230.25],[936.75, 231.75],[938.25, 232.5],[938.25, 234.75],[939.75, 238.5],[940.5, 241.5],[940.5, 244.5],[941.25, 247.5],[941.25, 249],[941.25, 249.75],[941.25, 250.5],[941.25, 249.75],[942, 248.25]]
    , [[970.5, 231],[970.5, 230.25],[970.5, 229.5],[970.5, 228],[970.5, 227.25],[970.5, 226.5],[970.5, 225.75],[969.75, 225],[969, 225],[968.25, 225],[967.5, 225.75],[966, 226.5],[964.5, 228],[963, 229.5],[961.5, 231.75],[960.75, 234],[959.25, 237],[958.5, 240.75],[957.75, 244.5],[957.75, 246.75],[958.5, 249],[959.25, 250.5],[960, 252],[961.5, 252],[963, 252],[965.25, 251.25],[966.75, 249.75],[967.5, 248.25],[969, 246],[969.75, 244.5],[970.5, 241.5],[971.25, 239.25],[971.25, 237],[971.25, 235.5],[971.25, 234],[971.25, 232.5],[971.25, 231.75],[971.25, 231],[972, 231.75],[972, 232.5],[972, 234.75],[972.75, 238.5],[973.5, 242.25],[974.25, 245.25],[974.25, 250.5],[975, 257.25],[975, 264.75],[975, 270.75],[974.25, 276],[972.75, 280.5],[970.5, 284.25],[967.5, 286.5],[964.5, 288.75],[960.75, 290.25],[957.75, 290.25],[954.75, 289.5],[952.5, 288.75],[950.25, 287.25],[948.75, 285.75],[948, 283.5],[948, 280.5],[949.5, 278.25],[951.75, 275.25],[955.5, 273],[959.25, 270.75],[963.75, 268.5],[969, 266.25],[975, 264.75],[980.25, 262.5],[985.5, 260.25]]
    ];


function resize(L,s){
    if (s == 1){
        return L;
    }
    var list2 = [];
    for (let i = 0; i < L.length; i++){
        let temp = [];
        for (let j = 0; j < L[i].length; j++){
            temp.push([L[i][j][0]*s, L[i][j][1]*s]);
        }
        list2.push(temp);
    }
    return list2;
}

var test_guide_spaceInk = [{
    'data': [[128, 630], [620, 710]],
    'id': 'guide1',
    'type': 'path'
},
{
    'data': [[58, 770], [575, 850]],
    'id': 'guide2',
    'type': 'path'
},
{
    'data': [[600, 850], [1100, 853]],
    'id': 'guide3',
    'type': 'path'
},
{
    'data': [[1225, 825], [1775, 825]],
    'id': 'guide4',
    'type': 'path'
}
];

var test_guide_spaceInk_margin = [{
    'data': [[15, 900-300], [140, 940-300]],
    'id': 'guide1',
    'type': 'path'
},
{
    'data': [[20, 900-225], [140, 940-225]],
    'id': 'guide2',
    'type': 'path'
// },
// {
//     'data': [[600, 850], [1100, 853]],
//     'id': 'guide3',
//     'type': 'path'
// },
// {
//     'data': [[1225, 825], [1775, 825]],
//     'id': 'guide4',
//     'type': 'path'
}
];

class Document extends Component {

    constructor(props) {
        super(props);
        this.state = {
            strokes: create_line(resize(list,6/10)),
            guides: test_guide_spaceInk_margin,
        }

        this.down = false;
        this.tempArrayStroke = [];
        this.buffer = [];
    }
    guid() {
        function s4() {
            return Math.floor((1 + Math.random()) * 0x10000)
            .toString(16)
            .substring(1);
        }
        return 'b' + s4() + s4() + s4() +  s4() +s4() +  s4() + s4() + s4();
    }
    deleteDetection(){
        var that = this;
        if (that.timer != null) {
          clearTimeout(that.timer);         
        }
    }  
    detect(){
        var arrayStroke = [];
        for (var i = 0; i < this.state.strokes.length; i++){
            if (this.buffer.indexOf(this.state.strokes[i]['id']) > -1){
                arrayStroke.push(JSON.parse(JSON.stringify(this.state.strokes[i])))
            }
        }
        var arrayGuide = JSON.parse(JSON.stringify(this.state.guides));     // MAKE A DEEP COPY of this.state.guides
        guide_global = computeLine(this, arrayStroke, guide_global, arrayGuide,distance); 
        let guide_new = updateGuide();
        guide_new != 0 ? this.state.guides.push(guide_new[0]) : this.state.guides;
        // console.log('This State Guide: ',this.state.guides)
        // let n = arrayStroke.length;
        // for (let i = 0; i < n; i++){
        //     console.log(arrayStroke[i]['data'])          // use to create 'list'
        // }
        this.buffer = [];
    }
    activateDetection(){
        var that = this;
        that.timer = setTimeout(function(){
          that.detect();
        }, 1500);
    }
    componentDidMount(){
        var that = this;
        this.listenEvents();
        d3.select('#canvasVisualization').style('width', '100%').style('height', '100%');
        
        distance = distance_guides(that.state.guides);
        setTimeout(function(){
            var strokes =  JSON.parse(JSON.stringify(that.state.strokes))
            var guide_var =  JSON.parse(JSON.stringify(that.state.guides))
            guide_global = computeLine(that, strokes, guide_var,guide_var,distance);
            let guide_new = updateGuide();
            guide_new != 0 ? that.state.guides.push(guide_new[0]) : that.state.guides;
            // guide_global = computeLine(that, strokes, that.state.guides); 
        }, 1000)
    }
    updateLines(strokes){

        strokes.forEach((stroke)=>{
            var index = this.state.strokes.indexOf(this.state.strokes.find(x => x.id == stroke.id));
            if (index > -1){
                // console.log(index)
                this.state = update(this.state, { 
                    strokes: { 
                                                                                                    [index] : {
                            data: {$set: stroke.data},
                        }
                    }
                })
            }
            // console.log(index)
        })


        // this.state.strokes.forEach((element, index)=>{
        //     if (this.buffer.indexOf(element['id']) > -1){
        //     this.state = update(this.state, { 
        //         strokes: { 
        //         [index] : {
        //                 shouldFadeOut: {$set: true},
        //             }
        //         }
        //     })
        //     }
        // })
        // console.log(strokes)
        // this.state = update(this.state, { 
        //     strokes: { 
        //     [0] : {
        //             data: {$set: dataPoints},
        //         }
        //     }
        // })
        // console.log(this.state)
        this.setState(this.state)
        
    } 
    listenEvents(){
        var that = this;

        d3.select('#canvasVisualization')
        .on('pointerdown', function(){
            that.down = true;
            that.deleteDetection();
        })
        .on('pointermove', function(){
            if (that.down == true){
                that.tempArrayStroke.push([d3.event.x, d3.event.y])
                that.drawTempStroke();
            }
        })
        .on('pointerup', function(){
            that.down = false;
            that.activateDetection();
            var id = that.guid()
            that.setState(prevState => ({ strokes: [...prevState.strokes, {
                    'data': that.tempArrayStroke,
                    'id': id
                }

            ]}));
            that.tempArrayStroke = [];
            that.removeTempStroke();

           
            that.buffer.push(id);
        })
    }
    removeTempStroke(){
        var line = d3.line()
        d3.select('#penTemp').attr("d", line([]))
    }
    drawTempStroke(){
        var that = this;
        var line = d3.line()
        d3.select('#penTemp')
            .attr("d", line(that.tempArrayStroke))
            .attr('fill', 'none')
            .attr('stroke', 'black')
            .attr('stroke-width', '2')
    }

    render() {
        return (
            <div>
                <svg id="canvasVisualization">
                    <Lines 
                        lines={this.state.strokes} 
                        
                    
                    />
                    <Guides guides={this.state.guides} />
                    <g id="tempLines">
                        <path id="penTemp"></path>
                    </g>
                </svg>
            </div>
        );
    }
}
export default Document;